# 集合

存储对象数据的一种容器。

![](https://jam-note-img.oss-cn-hangzhou.aliyuncs.com/leanote-img/20221027082819.png)

## 特点

- 大小不定，自适应大小，只要是对象就可以放；
- 适用于元素的增删。

如果要存基本类型时，使用包装类进行存储。

## 集合与数组的区别

- 数组存储类型确定、大小固定，集合存储类型不固定、大小可变；
- 数组可以存储基本类型和引用类型数据，集合只能存储引用类型的数据；
- 数组适用于数据大小类型确定的场景，集合使用与大小类型不确定<span style="color:red;">且</span>需要做增删操作的场景。

## Collection

抽象子类：

- List：元素有序、可重复、有索引，子类ArrayList、LinkedList；
- Set：元素无序、不重复、无索引，子类HashSet、LinkedHashSet（**有序**）、TreeSet（**按照大小默认升序**）。

类比数学：List 是**数学中数组**的一个子类，Set 是**数学中集合**的一个子类。

### ArrayList API

#### remove
```java
public boolean remove(Object o) {
    // 非空检验，为空则查找整个集合中的所有空项并清理空间
    if (o == null) {
        for (int index = 0; index < size; index++)
            if (elementData[index] == null) {
                fastRemove(index);
                return true;
            }
    } else {
        for (int index = 0; index < size; index++)
            if (o.equals(elementData[index])) {
                fastRemove(index);
                return true;
            }
    }
    return false;
}
```

#### add

```java
public boolean add(E e) {
    // 确认内存空间
    ensureCapacityInternal(size + 1);  
    // 添加该对象
    elementData[size++] = e;
    return true;
}
```

#### addAll

```java
public boolean addAll(Collection<? extends E> c) {
    // 将添加集合转换为对象
    Object[] a = c.toArray();
    int numNew = a.length;
    // 确认内存空间
    ensureCapacityInternal(size + numNew);  // 将要添加的集合放置在该集合之后
    System.arraycopy(a, 0, elementData, size, numNew);
    size += numNew;
    return numNew != 0;
}
```

#### clear

```java
public void clear() {
    modCount++;

    // 清空数据
    for (int i = 0; i < size; i++)
        elementData[i] = null;
    // 设置空间大小
    size = 0;
}

```

### 几种遍历元素的方法

```java
Iterator<Integer> I = list.iterator();
while (I.hasNext()) System.out.println(I.next());
```

```java
for (Integer i: list) System.out.println(i);
```

#### lambda

```java
list.forEach(new Consumer<Integer>() {
    @Override
    public void accept(Integer integer) {
        System.out.println(integer);
    }
});
```

化简：
```java
list.forEach(s -> System.Out.println(integer))
```


forEach源码：
```java
default void forEach(Consumer<? super T> action) {
    Objects.requireNonNull(action);
    for (T t : this) {
        action.accept(t);
    }
}
```
更简洁书写：
```java
list.forEach(System.out::println);
```

### 堆栈原理

![](https://jam-note-img.oss-cn-hangzhou.aliyuncs.com/leanote-img/20221027110635.png)